<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cglib | lizhouwei</title>
    <meta name="description" content="博学之，审问之，慎思之，眀辨之，笃行之">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.3e1d0bd1.css" as="style"><link rel="preload" href="/assets/js/app.b754686d.js" as="script"><link rel="preload" href="/assets/js/36.4c841ea5.js" as="script"><link rel="prefetch" href="/assets/js/10.dc6a57bc.js"><link rel="prefetch" href="/assets/js/11.05a7896a.js"><link rel="prefetch" href="/assets/js/12.87f729cc.js"><link rel="prefetch" href="/assets/js/13.b783eb80.js"><link rel="prefetch" href="/assets/js/14.fe15610f.js"><link rel="prefetch" href="/assets/js/15.4d747cf5.js"><link rel="prefetch" href="/assets/js/16.12cc21ce.js"><link rel="prefetch" href="/assets/js/17.87e584b1.js"><link rel="prefetch" href="/assets/js/18.a408f5f0.js"><link rel="prefetch" href="/assets/js/19.e175f669.js"><link rel="prefetch" href="/assets/js/2.81340e14.js"><link rel="prefetch" href="/assets/js/20.c6e6f090.js"><link rel="prefetch" href="/assets/js/21.b92c5565.js"><link rel="prefetch" href="/assets/js/22.eb576cbd.js"><link rel="prefetch" href="/assets/js/23.08a7db77.js"><link rel="prefetch" href="/assets/js/24.d61aae73.js"><link rel="prefetch" href="/assets/js/25.09c47cf9.js"><link rel="prefetch" href="/assets/js/26.116135c4.js"><link rel="prefetch" href="/assets/js/27.d0014973.js"><link rel="prefetch" href="/assets/js/28.9267b2b6.js"><link rel="prefetch" href="/assets/js/29.41694a7d.js"><link rel="prefetch" href="/assets/js/3.df97d12b.js"><link rel="prefetch" href="/assets/js/30.02a18457.js"><link rel="prefetch" href="/assets/js/31.a2736d54.js"><link rel="prefetch" href="/assets/js/32.b6f1a898.js"><link rel="prefetch" href="/assets/js/33.2327629e.js"><link rel="prefetch" href="/assets/js/34.d381e84e.js"><link rel="prefetch" href="/assets/js/35.61f98868.js"><link rel="prefetch" href="/assets/js/37.681ae4cb.js"><link rel="prefetch" href="/assets/js/38.58a9ee5e.js"><link rel="prefetch" href="/assets/js/39.4b09873b.js"><link rel="prefetch" href="/assets/js/4.283ac3a2.js"><link rel="prefetch" href="/assets/js/40.128c670d.js"><link rel="prefetch" href="/assets/js/41.4e5a175a.js"><link rel="prefetch" href="/assets/js/42.9931eddc.js"><link rel="prefetch" href="/assets/js/43.865cca26.js"><link rel="prefetch" href="/assets/js/44.5755d469.js"><link rel="prefetch" href="/assets/js/45.febddf97.js"><link rel="prefetch" href="/assets/js/46.7562b5b2.js"><link rel="prefetch" href="/assets/js/5.57704351.js"><link rel="prefetch" href="/assets/js/6.955fc97c.js"><link rel="prefetch" href="/assets/js/7.0d473d0c.js"><link rel="prefetch" href="/assets/js/8.156d9fda.js"><link rel="prefetch" href="/assets/js/9.9d034739.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e1d0bd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">lizhouwei</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">java语言</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">数据结构与算法</a></div><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lizhouwei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/lizhouwei/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">java语言</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">数据结构与算法</a></div><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lizhouwei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/lizhouwei/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>spring-core</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/framework/springCore/" class="sidebar-link">spring-core 包结构</a></li><li><a href="/framework/springCore/Asm.html" class="sidebar-link">Asm</a></li><li><a href="/framework/springCore/cglib.html" class="active sidebar-link">Cglib</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib代码包结构" class="sidebar-link">cglib代码包结构</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-core包" class="sidebar-link">cglib.core包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-bean包" class="sidebar-link">cglib.bean包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-reflect包" class="sidebar-link">cglib.reflect包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-proxy包" class="sidebar-link">cglib.proxy包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-util包" class="sidebar-link">cglib.util包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#cglib-transform包" class="sidebar-link">cglib.transform包</a></li><li class="sidebar-sub-header"><a href="/framework/springCore/cglib.html#参考地址" class="sidebar-link">参考地址</a></li></ul></li><li><a href="/framework/springCore/Objenesis.html" class="sidebar-link">Objenesis</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>spring-beans</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>spring-aop</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>springBoot</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="cglib"><a href="#cglib" aria-hidden="true" class="header-anchor">#</a> Cglib</h1> <p><a href="https://github.com/cglib/cglib" target="_blank" rel="noopener noreferrer">关于cglib的详细文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="概述"><a href="#概述" aria-hidden="true" class="header-anchor">#</a> 概述</h2> <p>Cglib是一个强大的高性能的字节码生成工具包。底层通过字节码增强处理框架 ASM，来生成字节码并装载到JVM。脚本语言Groovy也是使用ASM来生成或修改Java的字节码。</p> <p>很多时候在编译时期不能决定具体的对象类型，无法生成所需要的字节码。只能在运行时期，根据传入的实例，来生成字节码。这时就要用到动态代理。</p> <p>动态代理常见的有jdk动态代理和cglib代理两种方式。jdk代理方式基于接口实现，cglib则并没有局限于接口，采用的是生成子类的方式，只要被代理类和方法不被final修饰即可。</p> <h2 id="cglib代码包结构"><a href="#cglib代码包结构" aria-hidden="true" class="header-anchor">#</a> cglib代码包结构</h2> <div class="language- extra-class"><pre class="language-text"><code>cglib
  ├─beans (bean操作类)
  |  ├─BeanCopier
  |  ├─BulkBean
  |  ├─BeanMap
  |  ├─ImmutableBean
  |  └─BeanGenerator
  |
  ├─core (核心代码)
  |  ├─EmitUtils
  |  ├─ReflectUtils
  |  ├─KeyFactory
  |  ├─ClassEmitter/CodeEmitter
  |  ├─NamingPolicy/DefaultNamingPolicy
  |  ├─GeneratorStrategy/DefaultGeneratorStrategy
  |  ├─DebuggingClassWriter
  |  └─ClassGenerator/AbstractClassGenerator
  | 
  ├─reflect
  |  └─FastClass
  | 
  ├─proxy
  |  ├─Enhancer
  |  ├─CallbackGenerator
  |  ├─Callback
  |  |   ├─MethodInterceptor
  |  |   ├─Dispatcher
  |  |   ├─LazyLoader
  |  |   ├─ProxyRefDispatcher
  |  |   ├─NoOp
  |  |   ├─FixedValue
  |  |   └─InvocationHandler(提供和jdk proxy的功能)
  |  └─CallbackFilter
  ├─util
  |  ├─StringSwitcher
  |  └─ParallelSorter
  |
  └─transform
</code></pre></div><h2 id="cglib-core包"><a href="#cglib-core包" aria-hidden="true" class="header-anchor">#</a> cglib.core包</h2> <ul><li><strong>EmitUtils:</strong> 重要的工具类，主要封装了一些操作bytecode的基本函数，比如生成一个null_constructor，添加类属性add_property等。</li> <li><strong>ReflectUtils:</strong> 处理jdk reflect的工具类，比如获取一个类所有的Method，获取构造函数信息等。</li> <li><strong>ClassEmitter/CodeEmitter:</strong> 对asm的classAdapter和MethodAdapter的实现，贯穿于cglib代码的处理。</li> <li><strong>KeyFactory:</strong> 类库中重要的唯一标识生成器，在cglib做cache时做map key，比较底层的基础类。例如以下代码：<div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">BulkBeanKey</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">String</span> target<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> getters<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> setters<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> types<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token class-name">BulkBeanKey</span><span class="token punctuation">)</span><span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">BulkBeanKey</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>targetClassName<span class="token punctuation">,</span> getters<span class="token punctuation">,</span> setters<span class="token punctuation">,</span> typeClassNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>每个Key接口，都必须提供newInstance方法，但具体的参数可以随意定义，通过newInstance返回的为一个唯一标示，只有当传入的所有参数的equals都返回true时，生成的key才是相同的，这就相当于多key的概念。</li> <li><strong>NamingPolicy:</strong> 默认的实现类：DefaultNamingPolicy， 具体cglib动态生成类的命名控制。<br>
一般的命名规则：被代理class name + &quot;$$&quot; + 使用cglib处理的class name + &quot;ByCGLIB&quot; + &quot;$$&quot; + key的hashcode，例如：FastSource$$FastClassByCGLIB$$e1a36bab.class</li> <li><strong>GeneratorStrategy:</strong> 默认的实现类为：DefaultGeneratorStrategy，控制ClassGenerator生成class的byte数据，中间可插入自己的处理。注意这里依赖了：DebuggingClassWriter进行class generator的处理。</li> <li><strong>DebuggingClassWriter:</strong> cglib封装asm的处理类，用于生成class的byte流，通过GeneratorStrategy回调ClassGenerator.generateClass(DebuggingClassWriter)，将自定义的class byte处理回调给具体的cglib上层操作类，比如由具体的BeanCopier去控制bytecode的生成。</li> <li><strong>ClassGenerator:</strong> 其中一个抽象实现：AbstractClassGenerator。cglib代码中核心的Class bytecode操作主体，包含了一些cache，调用NamingPolicy，GeneratorStrategy进行处理，可以说是一个最核心的调度者。</li></ul> <h2 id="cglib-bean包"><a href="#cglib-bean包" aria-hidden="true" class="header-anchor">#</a> cglib.bean包</h2> <ul><li><strong>BeanCopier</strong><br>
适用两个Pojo Bean之间，所有属性的全复制，两边的source和target的属性可以不一致,以setter方法为准，调用getter方法获取数据。代码示例</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanCopierTest</span> <span class="token punctuation">{</span>  
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  

    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token class-name">DebuggingClassWriter</span><span class="token punctuation">.</span>DEBUG_LOCATION_PROPERTY<span class="token punctuation">,</span> <span class="token string">&quot;/tmp/1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//第三个参数useConverter，是否开启Convert，默认BeanCopier只会做同名，同类型属性的copier，否则就会报错。</span>
    <span class="token class-name">BeanCopier</span> copier <span class="token operator">=</span> <span class="token class-name">BeanCopier</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Source</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Target</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Source</span> from <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    from<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">Target</span> <span class="token keyword">to</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Converter</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigIntConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    copier<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> <span class="token keyword">to</span><span class="token punctuation">,</span> converter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//使用converter类  </span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">to</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">class</span> <span class="token class-name">BigIntConverter</span> <span class="token keyword">implements</span> net<span class="token punctuation">.</span>sf<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span><span class="token class-name">Converter</span> <span class="token punctuation">{</span>  
  
  <span class="token annotation punctuation">@Override</span>  
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">Class</span> target<span class="token punctuation">,</span> <span class="token class-name">Object</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// from类中的value对象  </span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// to类中的定义的参数对象  </span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// String对象,具体的方法名  </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span><span class="token class-name">BigInteger</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
<span class="token operator">--</span><span class="token operator">--</span>  
反编译后看的代码：  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Target</span>$$<span class="token class-name">BeanCopierByCGLIB</span>$$e1c34377 <span class="token keyword">extends</span> <span class="token class-name">BeanCopier</span> <span class="token punctuation">{</span>  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span> obj1<span class="token punctuation">,</span> <span class="token class-name">Converter</span> converter<span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token class-name">Target</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Target</span><span class="token punctuation">)</span>obj1<span class="token punctuation">;</span>  
    <span class="token class-name">Source</span> source <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Source</span><span class="token punctuation">)</span>obj<span class="token punctuation">;</span>  
    <span class="token comment">// 注意是直接调用，没有通过reflect  </span>
    target<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">BigInteger</span><span class="token punctuation">)</span>converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CGLIB$load_class$java$<span class="token number">2</span>Emath$<span class="token number">2</span>EBigInteger<span class="token punctuation">,</span> <span class="token string">&quot;setValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>避免每次进行BeanCopier.create创建对象，一般建议是通过static BeanCopier copier = BeanCopier.create()合理使用converter。<br>
应用场景：两个对象之间同名同属性的数据拷贝, 不能单独针对其中的几个属性单独拷贝</p></div> <ul><li><strong>BulkBean</strong><br>
相比于BeanCopier，BulkBean将整个Copy的动作拆分为getPropertyValues，setPropertyValues的两个方法，它可以指定特定的一组属性进行处理，然后可以调用getter，setter方法进行属性拷贝。一般会应用在动态注入属性是通过xml配置时，特别有用，拷贝特定的属性到指定的目标对象上。代码示例</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BulkBeanTest</span> <span class="token punctuation">{</span>  
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token class-name">DebuggingClassWriter</span><span class="token punctuation">.</span>DEBUG_LOCATION_PROPERTY<span class="token punctuation">,</span> <span class="token string">&quot;/home/ljh/cglib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> getter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;getValue&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> setter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;setValue&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> clazzs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  

    <span class="token class-name">BulkBean</span> bean <span class="token operator">=</span> <span class="token class-name">BulkBean</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">BulkSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> getter<span class="token punctuation">,</span> setter<span class="token punctuation">,</span> clazzs<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">BulkSource</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    obj<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objs <span class="token operator">=</span> bean<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> tmp <span class="token operator">:</span> objs<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token keyword">class</span> <span class="token class-name">BulkSource</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>  
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
<span class="token punctuation">}</span>  

<span class="token comment">// 反编译后的代码：　  </span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span> aobj<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  <span class="token class-name">BulkSource</span> bulksource <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BulkSource</span><span class="token punctuation">)</span>obj<span class="token punctuation">;</span>  
  aobj<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>bulksource<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>避免每次进行BulkBean.create创建对象，一般建议是通过static BulkBean.create copier = BulkBean.create()。<br>
应用场景：针对特定属性的get,set操作，一般适用通过xml配置注入和注出的属性，运行时才确定处理的Source,Target类，只需关注属性名即可。</p></div> <ul><li><strong>BeanMap</strong><br>
相比于BeanCopier和BulkBean，它可以用于解决pojo bean和map之间的转化，比如将一个map的属性赋值给一个bean上。几个支持的操作接口：</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>  <span class="token class-name">Object</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span>
  <span class="token class-name">Object</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span>
  <span class="token keyword">void</span> <span class="token function">putAll</span><span class="token punctuation">(</span><span class="token class-name">Map</span> t<span class="token punctuation">)</span>
  <span class="token class-name">Set</span> <span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token class-name">Collection</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">boolean</span> <span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span>
</code></pre></div><p>代码示例如下</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanMapTest</span> <span class="token punctuation">{</span>  
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 初始化  </span>
    <span class="token class-name">BeanMap</span> map <span class="token operator">=</span> <span class="token class-name">BeanMap</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pojo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// 构造  </span>
    <span class="token class-name">Pojo</span> pojo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pojo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    pojo<span class="token punctuation">.</span><span class="token function">setIntValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    pojo<span class="token punctuation">.</span><span class="token function">setBigInteger</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// 赋值  </span>
    map<span class="token punctuation">.</span><span class="token function">setBean</span><span class="token punctuation">(</span>pojo<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// 验证  </span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;intValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">class</span> <span class="token class-name">Pojo</span> <span class="token punctuation">{</span>  
  
    <span class="token keyword">private</span> <span class="token keyword">int</span>  intValue<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">BigInteger</span> bigInteger<span class="token punctuation">;</span>  
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment">//反编译代码查看：  </span>
<span class="token comment">//首先保存了所有的属性到一个set中  </span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">FixedKeySet</span> keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FixedKeySet</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>  
        <span class="token string">&quot;bigInteger&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;intValue&quot;</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span> obj1<span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token punctuation">(</span><span class="token class-name">Pojo</span><span class="token punctuation">)</span>obj<span class="token punctuation">;</span>  
  <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>obj1<span class="token punctuation">;</span>  
  s<span class="token punctuation">;</span>  
  s<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  JVM INSTR lookupswitch <span class="token number">2</span><span class="token operator">:</span> <span class="token keyword">default</span> <span class="token number">72</span>  
  <span class="token comment">//      -139068386: 40  </span>
  <span class="token comment">//       556050114: 52;  </span>
  <span class="token keyword">goto</span> _L1 _L2 _L3  
  _L2<span class="token operator">:</span>  
      <span class="token string">&quot;bigInteger&quot;</span><span class="token punctuation">;</span>  
　    <span class="token comment">//属性判断是否相等  </span>
      <span class="token function">equals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      JVM INSTR ifeq <span class="token number">73</span><span class="token punctuation">;</span>  
      <span class="token keyword">goto</span> _L4 _L5  
  _L5<span class="token operator">:</span>  
      <span class="token keyword">break</span> MISSING_BLOCK_LABEL_73<span class="token punctuation">;</span>  
  _L4<span class="token operator">:</span>  
      <span class="token function">getBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      <span class="token keyword">return</span><span class="token punctuation">;</span>  
  _L3<span class="token operator">:</span>  
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
<span class="token punctuation">}</span>  
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>避免每次进行BeanMap map = BeanMap.create();创建对象，不同于BeanCopier对象，BeanMap主要针对对象实例进行处理，所以一般建议是map.setBean(pojo);进行动态替换持有的对象实例。<br>
应用场景：针对put,putAll操作会直接修改pojo对象里的属性，所以可以通过beanMap.putAll(map)进行map&lt;-&gt;pojo属性的拷贝。</p></div> <ul><li><strong>BeanGenerator</strong><br>
BeanGenerator将一个Map&lt;String,Class&gt;properties的属性定义，动态生成一个pojo bean类。代码如下：</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>  <span class="token class-name">BeanGenerator</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  generator<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;intValue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  generator<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;integer&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  generator<span class="token punctuation">.</span><span class="token function">addProperty</span><span class="token punctuation">(</span><span class="token string">&quot;properties&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Properties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
          
  <span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token punctuation">)</span> generator<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token class-name">Object</span> obj <span class="token operator">=</span> generator<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    
  <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> getters <span class="token operator">=</span> <span class="token class-name">ReflectUtils</span><span class="token punctuation">.</span><span class="token function">getBeanGetters</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PropertyDescriptor</span> getter <span class="token operator">:</span> getters<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
      <span class="token class-name">Method</span> write <span class="token operator">=</span> getter<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>write<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
</code></pre></div><ul><li><strong>ImmutableBean</strong><br>
bean Immutable模式的一种动态class实现，Immutable模式主要应用于服务设计上，返回的pojo bean对象，不运行进行write方法调用。</li></ul> <h2 id="cglib-reflect包"><a href="#cglib-reflect包" aria-hidden="true" class="header-anchor">#</a> cglib.reflect包</h2> <p>用于对class,method处理</p> <ul><li><strong>FastClass</strong><br>
相比于java class对象，它利用了Index[]数组进行存储method,constructor。实现method.invoke，实际上是先找到FastClass存储的index下标，然后进行调用。使用上和Class没什么特殊的区别，只是多了这么一个index下标概念。</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FastClassTest</span> <span class="token punctuation">{</span> 

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token class-name">DebuggingClassWriter</span><span class="token punctuation">.</span>DEBUG_LOCATION_PROPERTY<span class="token punctuation">,</span> <span class="token string">&quot;/home/ljh/cglib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">FastClass</span> clazz <span class="token operator">=</span> <span class="token class-name">FastClass</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">FastSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// fast class反射调用  </span>
    <span class="token class-name">FastSource</span> obj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FastSource</span><span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    clazz<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&quot;setValue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    clazz<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&quot;setOther&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&quot;getValue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">int</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&quot;getOther&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> other<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// fastMethod使用  </span>
    <span class="token class-name">FastMethod</span> setValue <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;setValue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;setValue index is : &quot;</span> <span class="token operator">+</span> setValue<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">FastMethod</span> getValue <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;getValue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getValue index is : &quot;</span> <span class="token operator">+</span> getValue<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">FastMethod</span> setOther <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;setOther&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;setOther index is : &quot;</span> <span class="token operator">+</span> setOther<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token class-name">FastMethod</span> getOther <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;getOther&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getOther index is : &quot;</span> <span class="token operator">+</span> getOther<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">// 其他  </span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getDeclaredMethods : &quot;</span> <span class="token operator">+</span> clazz<span class="token punctuation">.</span><span class="token function">getJavaClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getConstructors : &quot;</span> <span class="token operator">+</span> clazz<span class="token punctuation">.</span><span class="token function">getJavaClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getFields : &quot;</span> <span class="token operator">+</span> clazz<span class="token punctuation">.</span><span class="token function">getJavaClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;getMaxIndex : &quot;</span> <span class="token operator">+</span> clazz<span class="token punctuation">.</span><span class="token function">getMaxIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">class</span> <span class="token class-name">FastSource</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> other<span class="token punctuation">;</span>  
  
<span class="token punctuation">}</span> 
</code></pre></div><h2 id="cglib-proxy包"><a href="#cglib-proxy包" aria-hidden="true" class="header-anchor">#</a> cglib.proxy包</h2> <p>用于对springAop相关的处理</p> <ul><li><p><strong>Callback &amp; CallbackGenerator</strong></p> <ol><li>MethodInterceptor<br>
类似于spring aop的around Advise的功能，大家都知道，不多做介绍。唯一需要注意的就是proxy.invokeSuper和proxy.invoke的区别。invokeSuper是退出当前interceptor的处理，进入下一个callback处理，invoke则会继续回调该方法，如果传递给invoke的obj参数出错容易造成递归调用。</li> <li>Dispatcher, ProxyRefDispatcher<br>
类似于delegate的模式，直接将请求分发给具体的Dispatcher调用，是否有着接口+实现分离的味道，将接口的方法调用通过Dispatcher转到实现target上。ProxyRefDispatcher与Dispatcher想比，loadObject()多了个当前代理对象的引用。反编译的部分代码代码</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">cal</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>  
  CGLIB$CALLBACK_1<span class="token punctuation">;</span>  
  <span class="token keyword">if</span><span class="token punctuation">(</span>CGLIB$CALLBACK_1 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">goto</span> _L2<span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token keyword">goto</span> _L1  
  _L1<span class="token operator">:</span>  
      JVM <span class="token class-name">INSTR</span> pop <span class="token punctuation">;</span>  
      CGLIB$<span class="token function">BIND_CALLBACKS</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      CGLIB$CALLBACK_1<span class="token punctuation">;</span>  
  _L2<span class="token operator">:</span>  
      <span class="token function">loadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//每次都进行调用  </span>
      <span class="token punctuation">(</span><span class="token class-name">DefaultCalcService</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      i<span class="token punctuation">;</span>  
      j<span class="token punctuation">;</span>  
      <span class="token function">cal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用实现类的方法  </span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre></div><ol start="3"><li>LazyLoader<br>
相比于Dispatcher,lazyLoader在第一次获取了loadObject后，会进行缓存，后续的请求调用都会直接调用该缓存的属性。反编译部分代码代码</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">cal</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">this</span><span class="token punctuation">;</span>  
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DefaultCalcService</span><span class="token punctuation">)</span>CGLIB$<span class="token function">LOAD_PRIVATE_3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cal</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">synchronized</span> <span class="token class-name">Object</span> CGLIB$<span class="token function">LOAD_PRIVATE_3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  CGLIB$LAZY_LOADER_3<span class="token punctuation">;</span> <span class="token comment">//保存的属性  </span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>CGLIB$LAZY_LOADER_3 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">goto</span> _L2<span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token keyword">goto</span> _L1  
  _L1<span class="token operator">:</span>  
      JVM <span class="token class-name">INSTR</span> pop <span class="token punctuation">;</span>  
      <span class="token keyword">this</span><span class="token punctuation">;</span>  
      CGLIB$CALLBACK_3<span class="token punctuation">;</span>  
      <span class="token keyword">if</span><span class="token punctuation">(</span>CGLIB$CALLBACK_3 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">goto</span> _L4<span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token keyword">goto</span> _L3  
  _L3<span class="token operator">:</span>  
      JVM <span class="token class-name">INSTR</span> pop <span class="token punctuation">;</span>  
      CGLIB$<span class="token function">BIND_CALLBACKS</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      CGLIB$CALLBACK_3<span class="token punctuation">;</span>  
  _L4<span class="token operator">:</span>  
      <span class="token function">loadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      JVM <span class="token class-name">INSTR</span> dup_x1 <span class="token punctuation">;</span>  
      CGLIB$LAZY_LOADER_3<span class="token punctuation">;</span>  
  _L2<span class="token operator">:</span>  
    <span class="token keyword">return</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre></div><ol start="4"><li>NoOp<br>
不做任何处理，结合Filter针对不需要做代理方法直接返回，调用其原始方法</li> <li>FixedValue<br>
强制方法返回固定值,可结合Filter进行控制</li> <li>InvocationHandler(提供和jdk proxy的功能),不常用</li></ol></li> <li><p><strong>CallbackFilter</strong><br>
主要的作用就是callback调度，主要的一个方法：int accept(Method method);<br>
返回的int在int值，代表对应method需要插入的callback，会静态生成到class的代码中，这样是cglib proxy区别于jdk proxy的方式，一个是静态的代码调用，一个是动态的reflect。<br>
可以查看： Enhancer类中的emitMethods方法，line:883。在构造class method字节吗之前就已经确定需要运行的callback。</p></li> <li><p><strong>Enhancer</strong><br>
一般知道个MethodInterceptor就差不多了，其他的callback可以不关注。目前直接写Enhancer应该不太多，用spring aop会比较多。示例如下：</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code>pbulic <span class="token keyword">class</span> <span class="token class-name">EnhancerTest</span><span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//设置代理类生成目录</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token class-name">DebuggingClassWriter</span><span class="token punctuation">.</span>DEBUG_LOCATION_PROPERTY<span class="token punctuation">,</span> <span class="token string">&quot;/home/ljh/cglib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">ApiLogInteceptor</span> apiLogInteceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiLogInteceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">CalDispatcher</span> calDispatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CalDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">CalcProxyRefDispatcher</span> calcProxyRefDispatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CalcProxyRefDispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">LazyLoaderCallback</span> lazyLoaderCallback <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LazyLoaderCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      
    <span class="token class-name">Enhancer</span> enhancer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//设置超类，因为cglib基于父类 生成代理子类</span>
    enhancer<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span><span class="token class-name">CalcService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置回调，也就是我们的拦截处理</span>
    enhancer<span class="token punctuation">.</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> apiLogInteceptor<span class="token punctuation">,</span> calDispatcher<span class="token punctuation">,</span> calcProxyRefDispatcher<span class="token punctuation">,</span>lazyLoaderCallback<span class="token punctuation">,</span> <span class="token class-name">NoOp</span><span class="token punctuation">.</span>INSTANCE <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// callback数组  </span>
    enhancer<span class="token punctuation">.</span><span class="token function">setCallbackFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CalcCallbackFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// filter </span>
    <span class="token comment">//创建代理类 </span>
    <span class="token class-name">CalcService</span> service <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">CalcService</span><span class="token punctuation">)</span> enhancer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token comment">//代用代理类的方法</span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">cal</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CalcService</span><span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">realMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;realMethod execute&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
  
<span class="token keyword">class</span> <span class="token class-name">ApiLogInteceptor</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objects<span class="token punctuation">,</span> <span class="token class-name">MethodProxy</span> methodProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before execute&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span> result<span class="token operator">=</span>methodProxy<span class="token punctuation">.</span><span class="token function">invokeSuper</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> objects<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;after execute&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">CalDispatcher</span> <span class="token keyword">implements</span> <span class="token class-name">Dispatcher</span><span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">loadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
     <span class="token comment">//</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="cglib-util包"><a href="#cglib-util包" aria-hidden="true" class="header-anchor">#</a> cglib.util包</h2> <ul><li><strong>StringSwitcher</strong> 提供string和int的map映射查询，给定一个string字符串，返回同个下标数组的int值，用Map不是可以很快速的实现功能</li> <li><strong>ParallelSorter</strong> 提供了一个二分的快速排序和多路归并排序。但没有所谓的并行排序。</li></ul> <h2 id="cglib-transform包"><a href="#cglib-transform包" aria-hidden="true" class="header-anchor">#</a> cglib.transform包</h2> <p>对asm的封装</p> <h2 id="参考地址"><a href="#参考地址" aria-hidden="true" class="header-anchor">#</a> 参考地址</h2> <p><a href="http://www.cnblogs.com/davidwang456/p/5654097.html" target="_blank" rel="noopener noreferrer">cglib源码分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/framework/springCore/Asm.html" class="prev">
          Asm
        </a></span> <span class="next"><a href="/framework/springCore/Objenesis.html">
          Objenesis
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.b754686d.js" defer></script><script src="/assets/js/36.4c841ea5.js" defer></script>
  </body>
</html>
