<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构建者模式 | lizhouwei</title>
    <meta name="description" content="博学之，审问之，慎思之，眀辨之，笃行之">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.3e1d0bd1.css" as="style"><link rel="preload" href="/assets/js/app.b754686d.js" as="script"><link rel="preload" href="/assets/js/24.d61aae73.js" as="script"><link rel="prefetch" href="/assets/js/10.dc6a57bc.js"><link rel="prefetch" href="/assets/js/11.05a7896a.js"><link rel="prefetch" href="/assets/js/12.87f729cc.js"><link rel="prefetch" href="/assets/js/13.b783eb80.js"><link rel="prefetch" href="/assets/js/14.fe15610f.js"><link rel="prefetch" href="/assets/js/15.4d747cf5.js"><link rel="prefetch" href="/assets/js/16.12cc21ce.js"><link rel="prefetch" href="/assets/js/17.87e584b1.js"><link rel="prefetch" href="/assets/js/18.a408f5f0.js"><link rel="prefetch" href="/assets/js/19.e175f669.js"><link rel="prefetch" href="/assets/js/2.81340e14.js"><link rel="prefetch" href="/assets/js/20.c6e6f090.js"><link rel="prefetch" href="/assets/js/21.b92c5565.js"><link rel="prefetch" href="/assets/js/22.eb576cbd.js"><link rel="prefetch" href="/assets/js/23.08a7db77.js"><link rel="prefetch" href="/assets/js/25.09c47cf9.js"><link rel="prefetch" href="/assets/js/26.116135c4.js"><link rel="prefetch" href="/assets/js/27.d0014973.js"><link rel="prefetch" href="/assets/js/28.9267b2b6.js"><link rel="prefetch" href="/assets/js/29.41694a7d.js"><link rel="prefetch" href="/assets/js/3.df97d12b.js"><link rel="prefetch" href="/assets/js/30.02a18457.js"><link rel="prefetch" href="/assets/js/31.a2736d54.js"><link rel="prefetch" href="/assets/js/32.b6f1a898.js"><link rel="prefetch" href="/assets/js/33.2327629e.js"><link rel="prefetch" href="/assets/js/34.d381e84e.js"><link rel="prefetch" href="/assets/js/35.61f98868.js"><link rel="prefetch" href="/assets/js/36.4c841ea5.js"><link rel="prefetch" href="/assets/js/37.681ae4cb.js"><link rel="prefetch" href="/assets/js/38.58a9ee5e.js"><link rel="prefetch" href="/assets/js/39.4b09873b.js"><link rel="prefetch" href="/assets/js/4.283ac3a2.js"><link rel="prefetch" href="/assets/js/40.128c670d.js"><link rel="prefetch" href="/assets/js/41.4e5a175a.js"><link rel="prefetch" href="/assets/js/42.9931eddc.js"><link rel="prefetch" href="/assets/js/43.865cca26.js"><link rel="prefetch" href="/assets/js/44.5755d469.js"><link rel="prefetch" href="/assets/js/45.febddf97.js"><link rel="prefetch" href="/assets/js/46.7562b5b2.js"><link rel="prefetch" href="/assets/js/5.57704351.js"><link rel="prefetch" href="/assets/js/6.955fc97c.js"><link rel="prefetch" href="/assets/js/7.0d473d0c.js"><link rel="prefetch" href="/assets/js/8.156d9fda.js"><link rel="prefetch" href="/assets/js/9.9d034739.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e1d0bd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">lizhouwei</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">java语言</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">数据结构与算法</a></div><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lizhouwei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/lizhouwei/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/java/" class="nav-link">java语言</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">数据结构与算法</a></div><div class="nav-item"><a href="/framework/" class="nav-link router-link-active">框架</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/lizhouwei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/lizhouwei/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>spring-core</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>spring-beans</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>spring-aop</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>springBoot</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>设计模式</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/framework/designmode/" class="sidebar-link">简介</a></li><li><a href="/framework/designmode/principle/" class="sidebar-link">设计模式遵循的设计原则</a></li><li><a href="/framework/designmode/UML.html" class="sidebar-link">统一建模语言UML</a></li><li><a href="/framework/designmode/FactoryMethod.html" class="sidebar-link">工厂方法模式</a></li><li><a href="/framework/designmode/AbstractFactory.html" class="sidebar-link">抽象工厂模式</a></li><li><a href="/framework/designmode/Builder.html" class="active sidebar-link">构建者模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#代码示例一" class="sidebar-link">代码示例一</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#未使用构建者模式" class="sidebar-link">未使用构建者模式</a></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#使用构建者模式" class="sidebar-link">使用构建者模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#抽象工厂模式优缺点" class="sidebar-link">抽象工厂模式优缺点</a></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#抽象工厂模式的本质" class="sidebar-link">抽象工厂模式的本质</a></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#抽象工厂模式使用场景" class="sidebar-link">抽象工厂模式使用场景</a></li><li class="sidebar-sub-header"><a href="/framework/designmode/Builder.html#相关设计模式" class="sidebar-link">相关设计模式</a></li></ul></li><li><a href="/framework/designmode/Facade.html" class="sidebar-link">外观模式</a></li><li><a href="/framework/designmode/Adapter.html" class="sidebar-link">适配器模式</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="构建者模式"><a href="#构建者模式" aria-hidden="true" class="header-anchor">#</a> 构建者模式</h1> <h2 id="简介"><a href="#简介" aria-hidden="true" class="header-anchor">#</a> 简介</h2> <p>构建者模式的实质是，将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</p> <p>构建者模式是用来分离一个复杂对象的构建过程和构建过程中具体的实现的。从而使得程序结构更松散、扩展更容易、复用性更好，同时也会使得代码更加清晰，意图更明确。</p> <p>虽然在生成器模式的整体构建算法中，会一步一步引导Builder来构建对象，但是这并不是说构建者主要就是用来实现分步骤构建对象的。<strong>构建者模式的重心还是在于分离整体构建算法和部件构造，而分步骤构建对象不过是整体构建算法的一个简单表现，或者说是一个附带物。</strong></p> <h2 id="代码示例一"><a href="#代码示例一" aria-hidden="true" class="header-anchor">#</a> 代码示例一</h2> <p>实现一个导出数据的应用框架,来让客户来选择数据的导出方式（txt格式、excel格式、xml格式）,并真正执行数据导出。在工厂模式时并没有涉及到每种方式具体是如何实现的，即没有涉及如何导出成txt、excel、xml等具体格式。例如对于具体的导出内容和格式的要求如下：</p> <ul><li>导出的文件，不管什么格式，都分为3个部分，分别为文件头、文件体、文件尾。</li> <li>在文件头部分，需要有分公司或者门市点编号、导出数据的日期，对于文本格式，中间用逗号分隔。</li> <li>在文件体部分，需要描述如下信息，表名称，然后分条描述数据，对于文本格式，表名称单独占一行，数据描述一行算一条数据，字段间用逗号分隔。</li> <li>在文件尾部分，需要有导出人。</li></ul> <h3 id="未使用构建者模式"><a href="#未使用构建者模式" aria-hidden="true" class="header-anchor">#</a> 未使用构建者模式</h3> <p>(1) 定义输出到文件头部的内容的对象。示例如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExportHeaderModel</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 分公司或门市点编号
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> depId<span class="token punctuation">;</span>

   <span class="token comment">/**
   * 导出数据日期
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> exportDate<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDepId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> depId<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDepId</span><span class="token punctuation">(</span><span class="token class-name">String</span> depId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>depId <span class="token operator">=</span> depId<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExportDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> exportDate<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExportDate</span><span class="token punctuation">(</span><span class="token class-name">String</span> exportDate<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>exportDate <span class="token operator">=</span> exportDate<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>定义输出数据的对象，示例代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExportDataModel</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 产品编号
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> productId<span class="token punctuation">;</span>

   <span class="token comment">/**
   * 销售价格
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>
  
   <span class="token comment">/**
   * 销售数量
   */</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> amount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> depId<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setProductId</span><span class="token punctuation">(</span><span class="token class-name">String</span> productId<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>productId <span class="token operator">=</span> productId<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> price<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>amount <span class="token operator">=</span> amount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>定义输出到文件尾的内容对象，示例代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExportFooterModel</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 导出人
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> exportUser<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getExportUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> exportUser<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setExportUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> exportUser<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>exportUser <span class="token operator">=</span> exportUser<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(2) 具体的导出实现</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExportToTxt</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 导出数据到文本文件
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm <span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token operator">&lt;</span><span class="token class-name">ExportDataModel</span> mapData<span class="token punctuation">,</span><span class="token class-name">ExportFooterModel</span> efm<span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//用来记录最终输出的文件内容</span>
    <span class="token class-name">StringBuffer</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1.先拼接文件头部内容</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>ehm<span class="token punctuation">.</span>getDepId<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getExportDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.拼接文件体的内容</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> tblName <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>tblName <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//然后循环拼接具体的数据</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ExportDataModel</span> edm <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tblName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>edm<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,&quot;</span>edm<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,&quot;</span> <span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//3.拼接文件尾的内容</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>efm<span class="token punctuation">.</span><span class="token function">getExportUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//4.控制台输出内容</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;输出文本文件的内容:\n&quot;</span><span class="token operator">+</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(3) 实现导出下xml格式的文件。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExportToXml</span> <span class="token punctuation">{</span>
   
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm<span class="token punctuation">,</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataMdoel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData <span class="token punctuation">,</span> <span class="token class-name">ExportFooterModel</span> efm<span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token class-name">StringBuffer</span> buffer  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//1。拼接文件头部内容</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;?xml version='1.0' encoding='gb2312'?&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Report&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Header&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;DepId&gt;&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getDepId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/DepId&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ExportDate&gt;&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getExportDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/ExportDate&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Header&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Body&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> tblName <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Datas TableName = \&quot;&quot;</span><span class="token operator">+</span>tblName<span class="token operator">+</span><span class="token string">&quot;\&quot;&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//然后循环拼接具体的数据</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ExportDataModel</span> edm <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tblName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Data&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ProductId&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;ProductId&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Price&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/Price&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Amount&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/Amount&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Data&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Datas&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/body&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Footer&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ExportUser&gt;&quot;</span><span class="token operator">+</span>efm<span class="token punctuation">.</span><span class="token function">getExportUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;ExportUser&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Footer&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Report&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//4.控制台输出内容</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;输出文本文件的内容:\n&quot;</span><span class="token operator">+</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(4) 客户端调用示例，代码如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token class-name">ExportHeaderModel</span> ehm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExportHeaderMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     ehm<span class="token punctuation">.</span><span class="token function">setDepId</span><span class="token punctuation">(</span><span class="token string">&quot;一分公司&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     ehm<span class="token punctuation">.</span><span class="token function">setDepId</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> col <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">ExportDataModel</span> edm1 <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportDataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setProductId</span><span class="token punctuation">(</span><span class="token string">&quot;产品001号&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">ExportDataModel</span> edm2 <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportDataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setProductId</span><span class="token punctuation">(</span><span class="token string">&quot;产品002号&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     col<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edm1<span class="token punctuation">)</span><span class="token punctuation">;</span>
     col<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edm2<span class="token punctuation">)</span><span class="token punctuation">;</span>

     mapData<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;销售记录表&quot;</span><span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">ExportFooterModel</span> efm <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportFooterModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     efm<span class="token punctuation">.</span><span class="token function">setExportUser</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//输出txt格式</span>
     <span class="token class-name">ExportToTxt</span> toTxt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExportToTxt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     toTxt<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>ehm<span class="token punctuation">,</span>mapData<span class="token punctuation">,</span>efm<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//输出xml格式</span>
     <span class="token class-name">ExportToTxt</span> toXml <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExportToTxt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     toXml<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span>ehm<span class="token punctuation">,</span>mapData<span class="token punctuation">,</span>efm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的实现不管是输出成文本文件，还是输出成下xml文件，实现的步骤基本一致。大致分为四步，</p> <ol><li>拼接文件头内容</li> <li>拼接文件体内容</li> <li>拼接文件尾内容</li> <li>把拼接好的内容输出成文件</li></ol> <p>也就是说对于不同的输出格式，处理步骤是一样的，但是每步的具体实现是不一样的，按照现在的实现方法，就存在以下问题：</p> <ul><li>构建每种输出格式的文件内容时都会重复这几个步骤，应该提炼出来作为公共处理过程。</li> <li>扩展其他输出格式时，能方便地切换到其他输出格式进行处理。</li></ul> <h3 id="使用构建者模式"><a href="#使用构建者模式" aria-hidden="true" class="header-anchor">#</a> 使用构建者模式</h3> <p>分析上面示例可知，构建过程就是构建每种格式的数据文件的处理过程，而不同的表示就是每种格式具体的步骤实现。因为不同的步骤实现，决定了最终的表现方式的不同。也就是说，上面的问题恰好就是构建者模式要解决的问题。</p> <p>要实现同样的构建过程可以创建不同的表现，就需要把构架过程独立出来，在构建者模式中把它称为指导者，由它来指导装配过程，但是不负责每步的具体实现。用构建者具体实现每步的对象。这样，指导者就是可以重复使用的构建过程，而构建者是可以切换为具体实现，在上面示例中，每种具体的导出文件格式的实现就相当于构建者。<br>
(1) 生成器接口定义的代码示例</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 定义创建一个产品对象所需的各个部件的操作
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   *  构建文件头部内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildHeader</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">/**
   *  构建文件Body内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildBody</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData<span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment">/**
   *  构建文件尾内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildFooter</span><span class="token punctuation">(</span><span class="token class-name">ExportFooterModel</span> efm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(2)具体构建者实现的示例代码<br>
导出为txt文件的代码示例</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token comment">/**
   * 导出成文本格式的构建者
   */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TxtBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>

   <span class="token comment">//用来记录最终输出的文件内容</span>
  <span class="token keyword">private</span>  <span class="token class-name">StringBuffer</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   *  构建文件头部内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildHeader</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//1.先拼接文件头部内容</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>ehm<span class="token punctuation">.</span>getDepId<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getExportDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

   <span class="token comment">/**
   *  构建文件Body内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildBody</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//2.拼接文件体的内容</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> tblName <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>tblName <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//然后循环拼接具体的数据</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ExportDataModel</span> edm <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tblName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>edm<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,&quot;</span>edm<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;,&quot;</span> <span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

   <span class="token comment">/**
   *  构建文件尾内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildFooter</span><span class="token punctuation">(</span><span class="token class-name">ExportFooterModel</span> efm<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//3.拼接文件尾的内容</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>efm<span class="token punctuation">.</span><span class="token function">getExportUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">StringBuffer</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> buffer<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>导出为XMl文件的代码示例</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XmlBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>

   <span class="token comment">//用来记录最终输出的文件内容</span>
  <span class="token keyword">private</span>  <span class="token class-name">StringBuffer</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   *  构建文件头部内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildHeader</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm<span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token comment">//1。拼接文件头部内容</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;?xml version='1.0' encoding='gb2312'?&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Report&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Header&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;DepId&gt;&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getDepId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/DepId&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ExportDate&gt;&quot;</span><span class="token operator">+</span>ehm<span class="token punctuation">.</span><span class="token function">getExportDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/ExportDate&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Header&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

   <span class="token comment">/**
   *  构建文件Body内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildBody</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData<span class="token punctuation">)</span><span class="token punctuation">{</span>
     buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Body&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> tblName <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Datas TableName = \&quot;&quot;</span><span class="token operator">+</span>tblName<span class="token operator">+</span><span class="token string">&quot;\&quot;&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//然后循环拼接具体的数据</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">ExportDataModel</span> edm <span class="token operator">:</span> mapData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tblName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Data&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ProductId&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;ProductId&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Price&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/Price&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Amount&gt;&quot;</span><span class="token operator">+</span>edm<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;&lt;/Amount&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Data&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Datas&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/body&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

   <span class="token comment">/**
   *  构建文件尾内容
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">buildFooter</span><span class="token punctuation">(</span><span class="token class-name">ExportFooterModel</span> efm<span class="token punctuation">)</span><span class="token punctuation">{</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;Footer&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;ExportUser&gt;&quot;</span><span class="token operator">+</span>efm<span class="token punctuation">.</span><span class="token function">getExportUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;&lt;ExportUser&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Footer&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/Report&gt;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">StringBuffer</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> buffer<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>(4)指导者的具体实现<br>
在有了构造者后，需要指导者指导它进行具体的产品构建，由于构建产品是文本内容，所以就不用单独定义产品对象了。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Director</span><span class="token punctuation">{</span>
  <span class="token comment">/**
   * CPU 的针脚数目
   */</span>
  <span class="token keyword">private</span> <span class="token class-name">Builder</span> builder<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Director</span><span class="token punctuation">(</span><span class="token class-name">Builder</span> builder<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>builder <span class="token operator">=</span> builder<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 <span class="token comment">/**
   * 指导构建者构建最终的产品对象
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">construct</span><span class="token punctuation">(</span><span class="token class-name">ExportHeaderModel</span> ehm <span class="token punctuation">,</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData<span class="token punctuation">,</span><span class="token class-name">ExportFooterModel</span> efm <span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//构建Header</span>
    builder<span class="token punctuation">.</span><span class="token function">buildHeader</span><span class="token punctuation">(</span>ehm<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//构建Body</span>
    builder<span class="token punctuation">.</span><span class="token function">buildBody</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//构建Footer</span>
    builder<span class="token punctuation">.</span><span class="token function">buildFooter</span><span class="token punctuation">(</span>efm<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(3) 客户端调用<br>
技嘉主板的实现</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token class-name">ExportHeaderModel</span> ehm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExportHeaderMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     ehm<span class="token punctuation">.</span><span class="token function">setDepId</span><span class="token punctuation">(</span><span class="token string">&quot;一分公司&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     ehm<span class="token punctuation">.</span><span class="token function">setDepId</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> mapData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> col <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ExportDataModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">ExportDataModel</span> edm1 <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportDataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setProductId</span><span class="token punctuation">(</span><span class="token string">&quot;产品001号&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm1<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">ExportDataModel</span> edm2 <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportDataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setProductId</span><span class="token punctuation">(</span><span class="token string">&quot;产品002号&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     edm2<span class="token punctuation">.</span><span class="token function">setAmount</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     col<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edm1<span class="token punctuation">)</span><span class="token punctuation">;</span>
     col<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>edm2<span class="token punctuation">)</span><span class="token punctuation">;</span>

     mapData<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;销售记录表&quot;</span><span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">ExportFooterModel</span> efm <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">ExportFooterModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     efm<span class="token punctuation">.</span><span class="token function">setExportUser</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//输出txt格式</span>
     <span class="token class-name">TxtBuilder</span>  txtBuilder  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TxtBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//创建指导者对象</span>
     <span class="token class-name">Director</span> directorTxt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Director</span><span class="token punctuation">(</span>txtBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
     directorTxt<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>ehm<span class="token punctuation">,</span>mapData<span class="token punctuation">,</span>efm<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//输出xml格式</span>
     <span class="token class-name">XmlBuilder</span>  xmlBuilder  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token comment">//创建指导者对象</span>
     <span class="token class-name">Director</span> directorXml <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Director</span><span class="token punctuation">(</span>xmlBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
     directorXml<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>ehm<span class="token punctuation">,</span>mapData<span class="token punctuation">,</span>efm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="抽象工厂模式优缺点"><a href="#抽象工厂模式优缺点" aria-hidden="true" class="header-anchor">#</a> 抽象工厂模式优缺点</h2> <p>抽象工厂模式优点</p> <ul><li>分离接口和实现<br>
客户端使用抽象工厂来创建需要的对象，而客户端根本不知道具体的实现是谁，客户端只是面向产品的接口编程而已，也就是说，客户端具体的产品中解耦。</li> <li>使得切换产品镞变得容易<br>
因为一个具体的工厂实现代表的是一个产品镞，比如上面例子的Shceme1代表装机方案一，Intel的CPU+技嘉的主板，如果要切换成Shceme2,那就变成装机方案二：AMD的CPU+微星的主板。<br>
客户端选用不同的工厂实现，就相当于是在切换不同的产品镞。</li></ul> <p>抽象工厂模式的缺点</p> <ul><li>不太容易扩展新的产品<br>
如果需要给整个产品镞添加一个新产品，那么就需要修改抽象工厂，这样就会导致修改所有的工厂实现类。</li> <li>容易造成类层次复杂<br>
在使用抽象工厂模式时，如果需要选择的层次过多，那么会造成整个类层次变得复杂。</li></ul> <h2 id="抽象工厂模式的本质"><a href="#抽象工厂模式的本质" aria-hidden="true" class="header-anchor">#</a> 抽象工厂模式的本质</h2> <p>工厂方法是选择单个产品的实现，虽然一个类里面可以有多个工厂，但这些方法之间一般是没有联系的，即使看起来像有联系。</p> <p>但是抽象工厂是为一个产品镞选择而实现的，定义在抽象工厂里面的方法通常是有联系的，它们都是产品的某一部分或者相互依赖的，如果抽象工厂里面只有定义一个方法，直接创建产品，那么就会退化成工厂方法。</p> <h2 id="抽象工厂模式使用场景"><a href="#抽象工厂模式使用场景" aria-hidden="true" class="header-anchor">#</a> 抽象工厂模式使用场景</h2> <ul><li>如果希望一个系统独立于它的产品的创建、组合和表示的时候，即希望一个系统只是知道产品的接口，而不关心实现的时候。</li> <li>如果一个系统要由多个产品系列中的某一个系类实现的时候。就可以动态的切换产品镞。</li> <li>如果要强调一系列相关产品的接口，以便于联合使用它们的时候。</li></ul> <h2 id="相关设计模式"><a href="#相关设计模式" aria-hidden="true" class="header-anchor">#</a> 相关设计模式</h2> <ul><li>抽象工厂模式和工厂方法模式<br>
工厂方法模式一般是针对单独的产品对象的创建，而抽象工厂模式注重产品镞对象的创建。<br>
如果把抽象工厂创建的产品镞简化，这个产品镞就只有一个产品，那么此时抽象工厂和工厂方法是差不多的，也就是抽象工厂可以退化为工厂方法。而工厂方法又可以退化成简单工厂。<br>
在抽象工厂的实现中，还可以使用工厂方法来提供抽象工厂的具体实现，也就是说他们可以组合使用。</li> <li>抽象工厂模式和单例模式<br>
在抽象工厂模式里面，具体的工厂实现，在整个应用中，通常一个产品系列只需要一个实例就可以了，因此可以把具体的工厂实现成为单例。</li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/framework/designmode/AbstractFactory.html" class="prev">
          抽象工厂模式
        </a></span> <span class="next"><a href="/framework/designmode/Facade.html">
          外观模式
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.b754686d.js" defer></script><script src="/assets/js/24.d61aae73.js" defer></script>
  </body>
</html>
